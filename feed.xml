<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="https://shuvom-s.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://shuvom-s.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2025-02-13T05:26:06+00:00</updated><id>https://shuvom-s.github.io/feed.xml</id><title type="html">Shuvom Sadhuka</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">Measuring Entropy</title><link href="https://shuvom-s.github.io/blog/2025/measuring-entropy/" rel="alternate" type="text/html" title="Measuring Entropy"/><published>2025-02-11T21:01:00+00:00</published><updated>2025-02-11T21:01:00+00:00</updated><id>https://shuvom-s.github.io/blog/2025/measuring-entropy</id><content type="html" xml:base="https://shuvom-s.github.io/blog/2025/measuring-entropy/"><![CDATA[<div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/entropy-480.webp 480w,/assets/img/entropy-800.webp 800w,/assets/img/entropy-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/entropy.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Is the entropy of generations from a large language model an overestimate or underestimate of the true entropy of human language? How would one even measure the entropy of human language? The question itself is poorly defined, but in this post I’ll try to tackle what it might mean to measure the entropy of a language.</p> <h2 id="a-basic-primer-on-entropy-and-previous-works">A Basic Primer on Entropy and Previous Works</h2> <p>To start, let’s recall the definition of entropy (for discrete variables):</p> \[H(X) = -\sum_{x \in A} p(x) \log_2 p(x)\] <p>Intuitively, entropy measures the amount of uncertainty present in a random variable $X$. The highest entropy distribution over $X$ would be the uniform distribution, and the lowest entropy would be a point mass (with 0 entropy, since $\log(1) = 0$).</p> <p>So if we want to measure the entropy of language, we’ll need to define two things: $A$, an alphabet we’ll measure over, and $p(x)$, a distribution over that alphabet. $A$ is fairly easy to define: the two natural approaches would be to let $A$ be characters (a, b, c, etc.) or words/tokens (the, ball, at, etc.). Let’s take $A$ to be words/tokens (like LLMs) for this post. The hard part is in estimating $p(x)$. We’ll call our estimate $q(x)$.</p> <p>Most naive approaches for measuring entropy of a language will likely overestimate the true entropy. For instance, one approach to estimate $p(x)$ would be to just use the empirical frequency of all words, but this would certainly overestimate entropy, because sentences are not constructed as sequences of random samples from the universe of words (e.g., “I is ball you” is not a valid sentence).</p> <p>A natural extension might be to consider 2-grams instead of 1-grams. Let’s measure the entropy of $p(x_1,x_0)$, for instance. This, too, will be an overestimate, because there are times when conditioning on the previous word is insufficient. For instance, every 2-gram in the sentence “I am red meat for you are here or there” is valid, but the sentence is nonsensical.</p> <p>In fact, the cross-entropy between any approximated model $q(x)$ like above and the true $p(x)$ will be an upper bound on the true entropy of $p(x)$. This is true mathematically because:</p> \[H(p,q) = H(p) + D_KL(p||q)\] <p>and KL divergence is non-negative. Cross entropy between $q(x)$ and $p(x)$ can be estimated empirically with text samples from a corpus (i.e., you get empirical samples from $p(x)$ and compare to your estimates $q(x)$).</p> <p>I’ve been slightly abusing notation here; technically the entropy we want to measure here is over a sequence, i.e. we want to measure</p> \[H(X) = -E_p \log P(x_0|x_{-1}, x_{-2}, …)\] <p>In other words, how much entropy is there in the distribution of the next word if I know all preceding words? These ideas and arguments have been thoroughly explored before, starting all the way from Claude Shannon himself in 1950 (shortly after he defined entropy in an earlier paper). I’d encourage you to read <a href="https://www.princeton.edu/~wbialek/rome/refs/shannon_51.pdf">his paper</a> — it’s not very long and full of interesting insights.</p> <p>The key insight is that if we let $F_n = H_n - H_{n-1}$, i.e. the conditional entropy of the n-gram model given the (n-1)-gram model, then we get that $H(X) = \lim_{n \rightarrow \infty} F_n$. In practice, of course, there are no $\inf$-grams, so Shannon calculates $F_n$ for small $n$ and tries to extrapolate the curve to predict the limit. Nowadays, we can probably easily compute 7-, 8-, and 9-grams on a standard laptop using a large corpus of text, which could give us a better sense of this limit. This also relates to a more general theorem known as the Shannon-McMillan-Breiman theorem, which states that for discrete-time finite-valued (both true here) stochastic processes:</p> \[H(X) \overset{p}{=} \lim_{n \rightarrow \infty} -\frac{1}{n} p(x_1, …, x_n)\] <p>There’s a catch to the theorem above that is worth noting. The theorem only holds for stationary ergodic processes (i.e., there exists a stationary distribution), but it’s clear that English (or more generally any language) is constantly evolving, as new words are added, old words become obsolete, and writing styles evolve.</p> <h2 id="a-thorny-qualm">A Thorny Qualm</h2> <p>The above approximation is neat but something still feels wrong to me. In some sense, the entropy of English is lower bounded by the number of plausible ideas there are in the world. That is, there are two layers in language, each of which has its own entropy:</p> <ol> <li> <p>The generation of ideas in our heads, which we can denote $p(\text{idea})$. Different people think about different ideas, so there’s significant heterogeneity across our population in $p(\text{idea})$.</p> </li> <li> <p>Expressing in words the abstract idea we’ve generated, which we can denote $p(x|\text{idea})$.</p> </li> </ol> <p>This might seem like a triviality, but I’d argue it’s important to break this down. The entropy of ideas is (probably) invariant across languages. Thus, the real quantity of interest (to me) is (2) — how much entropy is there in the valid ways to express an idea. Combining (1) and (2) into one step and just measuring entropy of expressed sentences (as Shannon did) risks two issues:</p> <ol> <li> <p>Certain languages have become the <em>lingua franca</em> of specific professions. For instance, one may accidentally observe more entropy in English than in Swahili, Italian, or Hindi, simply because English is the international language of scientific research, which is in the business of generating new ideas and hypotheses (hence likely higher entropy).</p> </li> <li> <p>The translation between ideas and expressions in (2) is imperfect. Anyone who is a bilingual speaker is likely to be familiar with this. For instance, I often find it more difficult to express complex thoughts in Bengali (the language I speak with some family) than English (my native language).</p> </li> </ol> <p>Measuring $p(x|\text{idea})$ is hard, though, because there’s no clean notion of what an “idea” is. We can also argue about the correct resolution of an idea. For instance, are the sentences <em>I am eating the sandwich</em>, <em>I am devouring the sandwich</em>, and <em>I am nibbling on the sandwich</em> all expressing the same idea? It depends on what resolution you’re looking at. All these sentences express some form of consuming a sandwich, but they differ in how vigorously that consumption is happening.</p> <p>The space of ideas is (probably) continuous, but to make progress we need some way of mapping out that space. I had this conversation with a couple friends last year — how can we create an embedding space for ideas? I’m not sure, but I think people are approaching aspects of this question in the LLM world.</p> <p>Let’s imagine we have a perfect idea embedding model. To measure entropy of $p(x|\text{idea})$, we could cluster (i.e., discretize) the space of ideas at some resolution and then measure $p(x|\text{idea})$, perhaps using some of the techniques above. There’s still a question of how to measure $p(x|\text{idea})$. One way might be to use a generative language model, by using some kind of decoder on the idea embeddings. This is not that far off; we can already measure the entropy of $p(x|\text{prompt})$ in most language models, many of which are decoder-only.</p> <p>But $p(x|\text{idea})$ as measured by the outputs of some decoder is probably going to be an underestimate of the true entropy. There are a couple reasons for this:</p> <ol> <li> <p>Most language models are designed to be safe (i.e., outputs are not toxic, false, etc.), which necessarily constrains the output space of the approximation $q(x|\text{idea})$ to be more concentrated than the true $p(x|\text{idea})$. However, people often do express themselves in unsavory ways like swearing or being impolite that are still valid expressions of their ideas. To be clear, I am not advocating for unsafe language models, I’m just noting that LLM safety likely lowers the output entropy.</p> </li> <li> <p>Language models probably interpolate and average the training data in some way, so wildly outlier $p(x|\text{idea})$ are unlikely to appear. I’m not sure increasing the sampling temperature would help significantly, though I’d be happy to see what results people have in this direction.</p> </li> </ol> <h2 id="final-remarks-and-connections-to-other-domains">Final Remarks and Connections to Other Domains</h2> <p>I’ve thought of variants of the above questions in human genetics as well. If we wanted to estimate the entropy of the human genome, a naive lower bound would be something like $\log_2(\text{total humans who have ever lived})$ and a naive upper bound would be $\log_2(4^{3 \text{billion}})$ since there are 3 billion base pairs in the human genome.</p> <p>Both of these numbers are wildly off, though. The lower bound is clearly off because it changes every time someone is born (and it’ll be a long, long time before we observe two people with identical genomes). The upper bound is off because most genes are under heavy evolutionary pressure, and a small string of mutations would kill the person.</p> <p>Genomes come with the additional twist that unlike English, the N-gram model would need to have an enormously long context to begin to understand the scaling of entropy as a function of $N$. Still, though, I think it could be useful to look at the entropy of 1- to 10-grams in DNA sequences (or similar) and see what the trend looks like. Perhaps a future post.</p> <p>Lastly, I want to note that I think the ideas point might have more salience. For instance, language models are often measured by their perplexities, with low perplexity indicating better performance. However, it’s unclear to me if higher perplexity is bad if the high perplexity comes from different generations that are semantically equivalent, even if the words are different (e.g., <em>The President of the United States is Donald Trump</em> and <em>Trump is the American president</em>).</p>]]></content><author><name></name></author><category term="sample-posts"/><category term="statistics"/><category term="language-models"/><category term="entropy"/><category term="genomics"/><summary type="html"><![CDATA[How would you measure the entropy of natural language?]]></summary></entry><entry><title type="html">A Statistical Analogy for Ethics</title><link href="https://shuvom-s.github.io/blog/2020/a-statistical-analogy-for-ethics/" rel="alternate" type="text/html" title="A Statistical Analogy for Ethics"/><published>2020-05-10T00:00:00+00:00</published><updated>2020-05-10T00:00:00+00:00</updated><id>https://shuvom-s.github.io/blog/2020/a-statistical-analogy-for-ethics</id><content type="html" xml:base="https://shuvom-s.github.io/blog/2020/a-statistical-analogy-for-ethics/"><![CDATA[<div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ethics-480.webp 480w,/assets/img/ethics-800.webp 800w,/assets/img/ethics-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/ethics.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>I’ve grown a little frustrated in how morality and moral law are often misused in public debate.</p> <p>To start, let’s consider what a moral framework entails. In some sense, moral philosophy is merely a model to determine whether an action is right or wrong. Different frameworks specify exact models for understanding right and wrong; some consider the output a spectrum; others consider it a binary; others even say it’s impossible to interpret any output.</p> <p>It’s important to note that the <em>model itself</em> is distinct from the <em>political legitimacy</em> of the model (i.e. how well a model is accepted as legitimate by the government). Our federal laws, for example, realize a philosophical model with strong political legitimacy, but federal laws are amended and changed when that model does not coincide with some other, “truer” philosophical framework.</p> <p>This notion may seem excruciatingly obvious, but you’ll frequently hear accusations of setting “arbitrary moral guidelines” or appeals to the constitution because it was “willed by the people.” These attacks only undermine the political legitimacy of the chosen moral framework, not the internal validity.</p> <p>It’s equally frustrating when critics of a certain moral framework find tiny, irrelevant exceptions as conclusive disproofs. Just as we wouldn’t discard a machine learning model because of occasional errors, we shouldn’t discard philosophical frameworks because we can find exceptions to them.</p> <p>Instead, a more convincing critique takes issue with the assumptions made by the model, similar to how we’d criticize a poorly applied machine learning method.</p> <p>Moreover, any philosophical framework necessarily makes simplifying assumptions and prescribes categorical laws. Utilitarians may shake their fists at me and argue that utilitarianism maximizes good, but I would argue that any framework attempts to maximize good, so this naive utilitarianism fails to prescribe action. Without an exact set of ascribed utilities to actions, I cannot guide my action to “maximize good.” And once you give me this set of weights, it’s almost certainly possible to find a counterexample.</p> <p>Reaching moral skepticism from these observations is even more preposterous: that would be equivalent to saying “because physics is sometimes contradictory, we should discard our entire conception of the universe.”</p> <p>To see how all of these pieces fit together, let’s imagine morality as a sort of mathematical problem. Imagine we have a set of (many, many) axes which contextualize each action we take (e.g. the time of the action, who is there, their positions in society, etc.—every possible degree-of-freedom of a given action). Each action we take is a dot in this large grid, and we wish to classify these dots as moral (“1”) or immoral (“0”) decisions (or a regression problem if you believe morality is a spectrum). There exists a true classification (although this is debatable), and we want to find a model that best approximates this true classification.</p> <p>We can, therefore, think of categorical laws such as “never steal” as analogous to simpler models like linear regression. We can add conditions to increase model complexity, such as “never steal unless the person is six feet tall and has seven kids.” More generally, model complexity, bias, and variance in machine learning can be analogized to moral frameworks:</p> <ol> <li> <p><strong>Model Complexity</strong>: As we increase model complexity, we lose interpretability, which is especially concerning in moral philosophy (which serve as interpretable guides to action), so we should penalize convoluted moral frameworks.</p> </li> <li> <p><strong>Interpretability</strong> Taken to an extreme, we can have vague and uninterpretable moral models, which, while perhaps technically “correct,” could be very “noisy” and uninterpretable, paralyzing action. Many formulations of utilitarianism fall under this umbrella, in which someone blindly asserts that the best thing to do is to do the most good and then quantifies some metric like maximizing total happiness. Absent a concrete method to achieve this ideal, utilitarianism can be used to justify almost any policy with some set of weights. Think about it: when is the last time a politician made an argument and didn’t invoke some form of “everyone will be better off?” Instead, if we trade some model complexity for categorical laws (which international law aims to do, for example), we may often achieve better results, even by the utilitarian’s own metrics, similar to how we often aim to achieve the optimal “tradeoff” between bias and variance in selecting machine learning models. Perhaps going down this path may lead one to <a href="https://en.wikipedia.org/wiki/Rule_utilitarianism">rule utilitarianism</a>.</p> </li> <li> <p><strong>Bias and Variance</strong>: While simple moral models may have high bias (i.e. inaccurate in many scenarios), complex moral models will have higher variance as they paralyze action. For example, many religious texts have complex moral guidelines, so we defer the interpretation to our denomination and priests, yielding higher model variance. On the other hand, simple moral guidelines like the Ten Commandments might incur significant contradictions, but are far more actionable.</p> </li> </ol> <p>While small and relatively trivial, this example illustrates how we can cross-apply other fields to guide understanding of ethical systems.</p> <p>It’s not a secret that different fields often employ their own jargon, which makes their ideas (slightly) inaccessible to other fields, but connecting ideas across fields (e.g. bias-variance tradeoff and moral philosophy) can illuminate how the same logic often underlies different results.</p>]]></content><author><name></name></author><category term="sample-posts"/><category term="statistics"/><category term="ethics"/><category term="law"/><summary type="html"><![CDATA[Reasoning about ethics via an analogy]]></summary></entry></feed>